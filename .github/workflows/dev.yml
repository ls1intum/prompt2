name: Build and Deploy to Dev

on:
  pull_request:
    branches: [main]

jobs:
  build-and-push-server:
    uses: ./.github/workflows/build-and-push-server.yml
    secrets: inherit
  build-and-push-clients:
    uses: ./.github/workflows/build-and-push-clients.yml
    secrets: inherit
  deploy-dev-container:
    needs: [build-and-push-clients, build-and-push-server]
    uses: ./.github/workflows/deploy_docker.yml
    secrets: inherit
    with:
      environment: Dev
      VM_HOST: ${{ vars.VM_HOST }}
      VM_USERNAME: ${{ vars.VM_USERNAME }}

